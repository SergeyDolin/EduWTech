# ОТТОК КЛИЕНТОВ
**Целью** исследования являлось создание модели способной прогнозировать, уйдёт клиент из банка в ближайшее время или нет.


**Выполненые задачи:**

- предобработка данных ✔️
- исследовать баланс классов ✔️
- изучить модели без учета дисбаланса ✔️
- применить методы балансировки данных ✔️
    - взвешивание классов
    - увеличение выборки
- достичь значения F1-меры 0.59 ✔️

**Структура датасета:**

- `RowNumber` — индекс строки в данных
- `CustomerId` — уникальный идентификатор клиента
- `Surname` — фамилия
- `CreditScore` — кредитный рейтинг
- `Geography` — страна проживания
- `Gender` — пол
- `Age` — возраст
- `Tenure` — сколько лет человек является клиентом банка
- `Balance` — баланс на счёте
- `NumOfProducts` — количество продуктов банка, используемых клиентом
- `HasCrCard` — наличие кредитной карты
- `IsActiveMember` — активность клиента
- `EstimatedSalary` — предполагаемая зарплата

Ключевым признаком являлся парметр `Exited` — факт ухода клиента. При разбиении данных на выборки (тренировачную, валидационную и тестовую) данные были стратифицированны. 


**Выбор модели**

Были рассмотрены три модели `DecisionTreeClassifier`, `RandomForestClassifier` и `LogisticRegression`.


**Обучение моделей без учета дисбаланса**

Время обучения и показатели метрик для валидационной выборки:
- `LogisticRegression` - 26.7 мс
    - F1 - 0.08
    - AUC-ROC - 0.69
- `DecisionTreeClassifier` - 3.45 с
    - F1 - 0.57
    - AUC-ROC - 0.82
- `RandomForestClassifier` - 11 мин 11 с
    - F1 - 0.63
    - AUC-ROC - 0.86


**Обучение моделей с учетом дисбаланса (балансировка веса)**

Время обучения и показатели метрик для валидационной выборки:
- `LogisticRegression` - 65.2 мс
    - F1 - 0.57
    - AUC-ROC - 0.83
- `DecisionTreeClassifier` - 3.52 с
    - F1 - 0.57
    - AUC-ROC - 0.81
- `RandomForestClassifier` - 11 мин 30 с
    - F1 - 0.63
    - AUC-ROC - 0.86


**Обучение моделей с учетом дисбаланса (балансировка веса + увеличение выборки)**

Время обучения и показатели метрик для валидационной выборки:
- `LogisticRegression` - 31.8 мс
    - F1 - 0.45
    - AUC-ROC - 0.72
- `DecisionTreeClassifier` - 5.15 с
    - F1 - 0.58
    - AUC-ROC - 0.82
- `RandomForestClassifier` - 18 мин 31 с
    - F1 - 0.61
    - AUC-ROC - 0.87
    

**Обучение моделей с учетом дисбаланса (балансировка веса + уменьшение выборки)**

Время обучения и показатели метрик для валидационной выборки:
- `LogisticRegression` - 15.3 мс
    - F1 - 0.45
    - AUC-ROC - 0.74
- `DecisionTreeClassifier` - 1.8 с
    - F1 - 0.57
    - AUC-ROC - 0.82
- `RandomForestClassifier` - 6 мин 48 с
    - F1 - 0.61
    - AUC-ROC - 0.87

Для тестирования была выбрана модель `RandomForestClassifier_b_model`

Результаты тестирования:

- `RandomForestClassifier_b_model` 
    - F1 - 0.60
    - AUC-ROC - 0.83

Результаты на тестовой выборке показали, что уровень F1 в 0.59 модель`RandomForestClassifier` с балансировкой классов проходит.

Предлагается в дальнейшем использовать модель `RandomForestClassifier` с балансировкой классов в силу наиболее точных результатов.
